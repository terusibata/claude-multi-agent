{
  "defaultAction": "SCMP_ACT_ALLOW",
  "comment": "Blacklist approach: allow all syscalls by default, explicitly block dangerous ones. This is more robust than the whitelist approach which was missing critical syscalls (chdir, setpgid, sigaltstack, etc.) causing silent container startup failures.",
  "archMap": [
    {
      "architecture": "SCMP_ARCH_X86_64",
      "subArchitectures": [
        "SCMP_ARCH_X86",
        "SCMP_ARCH_X32"
      ]
    },
    {
      "architecture": "SCMP_ARCH_AARCH64",
      "subArchitectures": [
        "SCMP_ARCH_ARM"
      ]
    }
  ],
  "syscalls": [
    {
      "names": [
        "mount",
        "umount",
        "umount2",
        "pivot_root",
        "chroot"
      ],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "comment": "Filesystem isolation: prevent mount namespace manipulation"
    },
    {
      "names": [
        "reboot",
        "kexec_load",
        "kexec_file_load"
      ],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "comment": "System control: prevent system reboot/shutdown"
    },
    {
      "names": [
        "init_module",
        "finit_module",
        "delete_module",
        "create_module"
      ],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "comment": "Kernel modules: prevent loading/unloading kernel modules"
    },
    {
      "names": [
        "ptrace",
        "process_vm_readv",
        "process_vm_writev",
        "kcmp"
      ],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "comment": "Process debugging: prevent debugging/tracing other processes"
    },
    {
      "names": [
        "settimeofday",
        "clock_settime",
        "adjtimex",
        "clock_adjtime"
      ],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "comment": "Time manipulation: prevent system clock modification"
    },
    {
      "names": [
        "swapon",
        "swapoff"
      ],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "comment": "Swap: prevent swap space manipulation"
    },
    {
      "names": [
        "acct"
      ],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "comment": "Process accounting: prevent enabling/disabling process accounting"
    },
    {
      "names": [
        "nfsservctl",
        "lookup_dcookie"
      ],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "comment": "NFS/profiling: prevent NFS server control and kernel profiling"
    },
    {
      "names": [
        "unshare",
        "setns"
      ],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "comment": "Namespaces: prevent namespace manipulation (container escape prevention)"
    },
    {
      "names": [
        "keyctl",
        "add_key",
        "request_key"
      ],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "comment": "Kernel keyring: prevent kernel key management"
    },
    {
      "names": [
        "bpf",
        "perf_event_open",
        "userfaultfd"
      ],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "comment": "Advanced kernel features: prevent BPF programs, perf events, and userfaultfd (attack surface reduction)"
    },
    {
      "names": [
        "open_by_handle_at",
        "name_to_handle_at"
      ],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "comment": "File handle operations: prevent bypassing filesystem access controls"
    },
    {
      "names": [
        "io_uring_setup",
        "io_uring_enter",
        "io_uring_register"
      ],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "comment": "io_uring: prevent io_uring usage (known attack surface in older kernels)"
    },
    {
      "names": [
        "move_mount",
        "fsopen",
        "fsconfig",
        "fsmount",
        "fspick",
        "open_tree",
        "mount_setattr"
      ],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "comment": "New mount API: prevent filesystem mount operations via new kernel API"
    }
  ]
}
